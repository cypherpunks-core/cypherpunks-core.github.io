<!DOCTYPE html>
<html lang="{{ site.lang | default: 'zh-TW' }}" class="dark">
<head>
  {% include head.html %}
</head>
<body class="min-h-screen flex flex-col bg-cp-dark text-cp-dark-800">
  <!-- Matrix Rain Background -->
  {% if site.theme_settings.enable_matrix %}
  <div id="matrix-rain" class="matrix-rain"></div>
  {% endif %}

  <!-- Scanlines Effect -->
  {% if site.theme_settings.enable_scanlines %}
  <div class="scanlines pointer-events-none fixed inset-0 z-50"></div>
  {% endif %}

  <!-- Reading Progress Bar -->
  <div id="reading-progress" class="reading-progress" style="width: 0%;"></div>

  <!-- Skip to Content (a11y) -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-cp-green-600 focus:text-cp-dark focus:rounded">
    跳至主要內容
  </a>

  <!-- Header / Navigation -->
  {% include header.html %}

  <!-- Hero Section -->
  {% unless page.hide_hero or layout.hide_hero %}
  {% include hero.html %}
  {% endunless %}

  <!-- Main Content -->
  <main id="main-content" class="flex-grow">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
      <div class="flex flex-col lg:flex-row gap-8">

        <!-- Sidebar (Left) - Optional Menu -->
        {% if page.menubar %}
        <aside class="lg:w-64 flex-shrink-0" role="navigation" aria-label="側邊選單">
          {% include menubar.html %}
        </aside>
        {% endif %}

        <!-- Main Content Area -->
        <article class="flex-grow min-w-0 {% if page.show_sidebar %}lg:max-w-4xl{% else %}max-w-4xl mx-auto{% endif %}">
          {{ content }}
        </article>

        <!-- Sidebar (Right) - Latest Posts -->
        {% if page.show_sidebar and site.posts.size > 0 %}
        <aside class="lg:w-80 flex-shrink-0" role="complementary" aria-label="最新文章">
          {% include sidebar.html %}
        </aside>
        {% endif %}

      </div>
    </div>
  </main>

  <!-- Footer -->
  {% unless page.hide_footer %}
  {% include footer.html %}
  {% endunless %}

  <!-- Search Modal -->
  {% include search-modal.html %}

  <!-- Scripts -->
  <script src="{{ '/assets/js/app.js' | relative_url }}"></script>
  {% include footer-scripts.html %}
</body>
</html>
